<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

</body>
</html>

<script type="text/javascript">
    // ——————————————————————01.  ——————————————————————————
    // ——————————————————————01.  Promise 的含义——————————————————————————
    // Promise 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大。它由社区最早提出和实现，ES6 将其写进了语言标准，统一了用法，原生提供了Promise对象。
    // Promise实例
    //    {
    //        const promise = new Promise(function (resolve, reject) {
    //            // ... some code
    //            if (/* 异步操作成功 */) {
    //                resolve(value);
    //            } else {
    //                reject(error);
    //            }
    //        });
    //    }

    // 举个栗子
    //    {
    //
    //        let promiss = new Promise(function (resolve, reject) {
    //            setTimeout(function () {
    //                resolve('1s后执行了');
    //            }, 1000)
    //        });
    //
    //        promiss.then((res) => {
    //            console.log(res)
    //        })
    //    }


    // 执行顺序
    //    {
    //        new Promise((resolve, reject) => {
    //            console.log('resolve')
    //            resolve()
    //        })
    //            .then(res => {
    //                console.log('success')
    //            });
    //        console.log('普通的console')
    //        //resolve
    //        //普通的console
    //        // success
    //    }


    // 异步加载图片的实例
    //    {
    //        function loadImage(url) {
    //            return new Promise(function (resolve, reject) {
    //                const image = new Image();
    //                image.onload = function () {
    //                    // 说明加载成功
    //                    resolve('图片加载成功了');
    //                }
    //                image.onerror = function () {
    //                    // 说明加载失败
    //                    reject(new Error('图片加载失败'));
    //                }
    //                image.src = url;
    //            })
    //        }
    //        loadImage('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1561367381&di=768decee7422fcf22524c49fb98f4ab3&imgtype=jpg&er=1&src=http%3A%2F%2Fwww.qqoi.cn%2Fimg_bizhi%2F245213297.jpeg')
    //            .then(res => {
    //                console.log(res);
    //            }, err => {
    //                console.log(err)
    //            })
    //    }


    // 异步请求网络数据
    //    {
    //        const getJSON = function (url) {
    //            const promise = new Promise(function (resolve, reject) {
    //                const handler = function () {
    //                    if (this.readyState !== 4) {
    //                        return;
    //                    }
    //                    if (this.status === 200) {
    //                        resolve(this.response);
    //                    } else {
    //                        reject(new Error(this.statusText));
    //                    }
    //                };
    //                const client = new XMLHttpRequest();
    //                client.open("GET", url);
    //                client.onreadystatechange = handler;
    //                client.responseType = "text";
    //                client.setRequestHeader("Accept", "application/text");
    //                client.send();
    //
    //            });
    //
    //            return promise;
    //        };
    //
    //        getJSON('http://www.originoo.com/ws/p.index.php').then(function (res) {
    //            console.log(res);
    //        }, function (error) {
    //            console.error('出错了', error);
    //        });
    //    }


    //    {
    //        const p1 = new Promise((resolve, reject) => {
    //            console.log('p1执行了')
    //            setTimeout(() => {
    //                reject(new Error('出现错误了'));
    //            }, 3000)
    //        })
    //
    //        new Promise((resolve, reject) => {
    //            console.log('p2执行了')
    //            resolve(p1);
    //        })
    //            .then(res => {
    //                console.log('结果', res)
    //            })
    //            .catch(e => {
    //                console.log(e)
    //            })
    //    }


    // ——————————————————————04. Promise.prototype.catch()——————————————————————————
    // Promise.prototype.catch方法是.then(null, rejection)或.then(undefined, rejection)的别名，用于指定发生错误时的回调函数。
    //    {
    //        new Promise((resolve, reject) => {
    //            reject('出错啦1111')
    //        })
    //            .then(res => {
    //                console.log('success', res)
    //            }, err => {
    //                console.log('failed', err)   // 会走此方法
    //            })
    //            .catch(e => {
    //                console.log('catch', e)
    //            })
    //
    //
    //        new Promise((resolve, reject) => {
    //            reject('出错啦222')
    //        })
    //            .then(res => {
    //                console.log('success', res)
    //            }, err => {
    //                console.log('failed', err)   // 会走此方法
    //            })
    //            .catch(e => {
    //                console.log('catch', e)
    //            })
    //    }






</script>